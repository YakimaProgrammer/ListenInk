#! /bin/bash

# Is it a security vulnerability to expose parts of our server infastructure like this? Certainly

if [ $(hostname) != listenink ]; then
  echo "You probably meant to run this script on the server. Try running `./deploy.sh` instead!"
  exit 1
fi

cd /opt/ListenInk
git pull

cd frontend
npm i
npm run build
cd build
rm -rf /var/www/listenink.app/*
mv * /var/www/listenink.app
cd ..
rmdir build

cd ..

cd backend
npm i

sudo systemctl restart listenink-backend
